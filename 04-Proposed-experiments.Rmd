

# Proposed experiments and papers {#proposed-experiments}


```{r setup, include = FALSE}
knitr::opts_chunk$set(
  echo = F, warning = F, message = F,
  out.width = '90%', fig.align = 'center', 
  dpi = 72)

```

```{r load-packages, eval=TRUE}
suppressPackageStartupMessages({
  library(tidyverse)
  library(kableExtra)
  library(magick)
  library(patchwork)
  })
```


This section details my planned research. 

I have organized this section into the 5 papers I plan to publish and ultimately compile as my dissertation.
Two are nearly complete. 
Each sub-section describes the paper's focus, my hypotheses, and how I plan to collect and analyze the data.

I spent the bulk of the past 12 months developing and validating the method described in Section \@ref(cleatmark-method-development-chapter).
I also completed collecting data for the experiment described in Section \@ref(oversize-particles-atterberg-limits-experiment).
Figure \@ref(fig:gantt-chart) shows envisaged timelines for the rest of the project. 

```{r gantt-chart, fig.cap='Estimated windows for completing dissertation research and other degree requirements', fig.scap='Project Gantt chart', out.width='99%'}
knitr::include_graphics('figs/pdf/phd-gantt-chart.pdf')
```


## Paper 1: Cleat-in cleat out method {#cleatmark-method-development-chapter}

Paper title: 

:  **A laboratory method to measure deformation of baseball and softball infield skin soils** 

### Overview 

This paper outlines a new test method to measure the cleat-in/cleat-out effect described in Section \@ref(corkboard-effect-section).
The goal of the test is to identify a single water content at which a soil transitions abruptly from cleat-in cleat-out behavior to a clod-forming failure mode.

The level of detail given in this section could be viewed as excessive, but I feel it is the appropriate place to document my efforts in creating the method. 
It has many steps and each has been validated independently.

Developing a method from scratch is hardly a linear process.
I have done my best to move in a logical order and in this spirit, I have left many of the ancillary calculations in the Appendix.
My intent is to avoid disrupting the document's flow while ensuring everything is available should the reader wish to scrutinize the details.

### Principal research questions

1. Can a laboratory method replicate the interaction between an athlete's footwear and a small soil specimen?
2. What measurements best enumerate the cleat-in/cleat-out effect?
3. How accurate and repeatable is the method?

### Hypotheses

1. The cleat-in/cleat-out phenomenon described in Section \@ref(corkboard-effect-section) can be duplicated using a machine and a laboratory-sized soil specimen, rather than outdoor plots and human subjects. 
1. The means by which the soil specimen is prepared will affect the test result. Therefore, a protocol must be developed which adequately emulates the real procedures used for construction and maintenance of infield skins. The method must also simulate outdoor conditions to adjust the soil water content.
1. Subjective assessments can be eliminated through use of 3D scanning technology to measure the response of the soil. 
1. For a given soil, a critical water content threshold $\theta_{crit}$ can be identified where disruption of the surface is minimized.
1. The obtained water content from (4) will be similar across multiple surface metrics (i.e. volume change, surface area, curvature) but different across soils. 

### Materials and Methods

A mechanical apparatus was fabricated to emulate the interaction between a baseball or softball athlete's cleated footwear and a soil surface. (Figure \@ref(fig:cleat-mark-device)). The device was designed and fabricated in spring of 2020 by the Penn State State Engineering Services Shop. 

```{r cleat-mark-device, fig.cap="Left: The pneumatic apparatus used to simulate foot-to-surface interaction. Right: A typical 9-spike baseball cleat pattern.", fig.scap="Pneumatic cleat-mark testing device", fig.show="hold", fig.align='default', out.width="50%", eval=TRUE}

knitr::include_graphics('images/cleatmark_device.png')
knitr::include_graphics('images/nine-spike-pattern.jpg')

```


The apparatus comprises a pneumatic cylinder, a guide shaft, and and a plate for mounting baseball cleats removed from an actual shoe. 
The device is charged by a benchtop air compressor. Pneumatic power was chosen for its combination of high travel speed with good control of the peak load. 

There are five main steps in the test: 

1. Prepare the soil specimen
2. Produce cleat indentations with the apparatus
3. Record a 3D mesh of the tested specimen
4. Determine the water content of a small, representative sample
5. Derive surface properties from the mesh

Each step was individually scrutinized through small pilot experiments to develop an optimal procedure. Investigated parameters include:

**Sample preparation**:

- compaction energy (standard vs. modified Proctor routine)
- drydown procedure (heat lamp type, wattage, distance, duration)
- timing of water additions and repairs

**Device operation:**

- loading pressure 
- number of cleats
- orientation of cleats
- torsion angle

**Scanner configuration**:

- angle from horizontal
- distance from specimen
- rotational step size 

**Morphometric analysis**:

- cleaning and orientation adjustments
- pointcloud reduction (decimation)
- comparison of derived morphometrics


#### Method details

The next series of sub-sections describe the method in detail, from creating a soil mixture to a final result. 


##### Producing the mix

Modern infield soils are blended from two components - a nearly pure sand, and a fine-grained soil. 
Mixes are often categorized on the basis of their total sand-size content. 
For the purpose of simplicity, this sub-section refers to the two mixture components as "sand" and "clay", temporarily ignoring these terms' important particle-size and mineralogical connotations.
Nearly all "sands" have a measurable quantity of particles <2 &mu;m sieve diameter, and nearly all "clays" have a measurable quantity of particles >50 &mu;m.^[the lower boundary of sand-size particles as defined by USDA classification system [@USDA1999]  ]
The soils are mixed in an air-dry condition so their hygroscopic water content must also be considered. 
Therefore, to produce a mixture having $S$% percent sand-size particles by oven-dry mass requires knowledge of:

- the fines content of the "sand" 
  
- the sand content of the "clay" 
  
- the extant gravimetric water content $w$ of each component. 

The air-dry masses of each soil are then computed from a basic 2-member system of equations. 
A complete derivation is provided in the Appendix (Section \@ref(sand-clay-mix-calcs)). 
The resulting formulae are given in Equations \@ref(eq:sand-clay-ratios-air-dry-sand-mass) and \@ref(eq:sand-clay-ratios-air-dry-clay-mass):


\begin{align}
  \text{Sand air-dry mass (kg)} &= \frac{S_{final}-S_{clay}}{S_{sand} - S_{clay}}  \cdot m_{total~mixture~(kg)} \cdot (1+w_{sand })
(\#eq:sand-clay-ratios-air-dry-sand-mass) \\
\nonumber \\
\text{Clay air-dry mass (kg)} &= \left[1 - \left( \frac{S_{final} - S_{clay}}{S_{sand} - S_{clay}} \right) \right] \cdot m_{total~mixture~(kg)} \cdot (1+w_{clay})
(\#eq:sand-clay-ratios-air-dry-clay-mass)
\end{align}



To make these calculations efficient and reproducible, the above forumlae were compiled into a set of functions using the R Language for Statistical Computing [@R-core2021].


#### Preparing the specimen

An important consideration in this test's development is accurately simulating the conditions encountered on actual infields. As discussed in Section \@ref(ball-response-lit-review), infield soils are intentionally compacted to extremely high densities.
The infield also undergoes frequent wetting and drying cycles. These affect soil water potential and may also induce volume change. Therefore the sample preparation routine was developed using two main criteria:

1. Emulate the conditions found on actual infields 

2. Reduce operator-dependence by using standardized procedures for compaction and repairs


##### Choosing a compaction routine 

It was deemed most appropriate to compact each sample at its respective optimum water content ($w_{opt}$).^[A possible alternative would be to compact every soil to the same value of $\rho$, but soils at the same $\rho$ will behave quite differently depending on their texture and mineralogy.] Therefore, a compaction test was required _prior_ to any sample construction for actual cleat-mark testing. 

$w_{opt}$ is not fixed for a given soil - it depends on the compaction effort used in the test. 
The two most widely-used compaction tests are the Standard and Modified Proctor tests, designated by ASTM D698 and D1557 [@ASTMD698-12; @ASTMD15572015].
It is not immediately clear which Proctor test corresponds better to infield soil construction. 
The equipment used to compact infield soils is generally smaller than that used for larger earthworks projects.
Unfortunately there is no straightforward conversion from a roller size used in actual construction activity to the compaction energy applied during a laboratory test. 
@Selig1971 provided a formula for the simple case of a cylindrical drum towed across a soil surface, but this type of equipment is rarely used on infields. Furthermore, the calculation depends on the coefficient of rolling resistance which varies with water content and soil stiffness. 

An analytical solution is not necessarily required. Both Proctor test varieties were developed by comparing the laboratory test results with densities observed in successful earthworks projects [@Proctor1933a; @Holtz2010]. 
A similar empirical approach was taken for this study. 

Compaction tests were performed at both efforts on a widely-used commercial infield mix (60% sand).
A value for $\rho_{max}$ was derived from each compaction curve using a spline-fitting routine in R.
See the Appendix for more details on the fitting routine (\@ref(deriving-values-from-proctor-curves)).

The $\rho_{max}$ values from these lab tests were compared with $\rho_{bulk}$ of an MLB infield constructed with the same soil. 
Figure \@ref(fig:proctor-vs-observed-infield-density) shows that the observed values from the stadium fall somewhat between those attained with the two lab tests. 
Recall that all of these values for $\rho$ are somewhat higher than those used in prior infield soils research (c.f. Figure \@ref(fig:lit-review-density-comparison)).


(ref:proctor-vs-observed-infield-density-caption) For a popular commercial infield mix, dry density values observed on a professionally managed infield surface lie between those achieved with the Standard and Modified Proctor tests.


```{r proctor-vs-observed-infield-density, fig.cap='(ref:proctor-vs-observed-infield-density-caption)', fig.scap='Proctor tests compared with $\rho_{bulk}$ of an actual infield'}
knitr::include_graphics('../../cleatmarkmethod/figs/pdf/proctor-vs-observed-infield-density.pdf')
```

A pilot experiment was also performed to determine if a notable difference in sample behavior occurred between the two energy levels.
Two soils were used in this experiment. 
These were mixed from the same sand and clay components to yield mixtures of 60 and 75% sand. 
Fresh batches of each air-dry soil were brought to their respective $w_{opt}$ for the two energy levels. 
The material was thoroughly hand-mixed with the appropriate mass of water and allowed to cure for &GreaterEqual;16 hr. 

The soil was next compacted into the cleat-mark cylinders with the appropriate number of blows.
Due to the geometry of the cleat-mark cylinders this required a conversion for the compaction energy per unit volume of soil. 
This calculation is detailed in the Appendix, Section \@ref(cleat-mark-energy-per-vol-conversion).
The standard routine used 2 lifts with 56 blows per lift.
The modified routine used 3 lifts with 63 blows per lift (See Equation \@ref(eq:modified-energy-per-volume-appendix)).

##### Comparison of density achieved during Proctor tests and cleat-mark compaction routine 

To validate the energy conversion, the masses and water contents of each prepared cleat-mark cylinder were recorded following compaction.
Three replicates of both soils at both energies were prepared, for a total of 12 specimens. 

These were compared with the corresponding values of $\rho_{max}$ derived from the original Proctor tests.

```{r compute-pooled-sd-for-3-cleatmark-replication-densities}
patton_mocha_metadata <- readr::read_csv('../../cleatmarkmethod/ecmdata/metadata/mixture-descriptions-and-metadata.csv', col_types = 'cccfc')

tin_tares <- do.call(rbind, asi468::tin_tares)

Gs <- 2.7

cleatmark_qc_data <- readr::read_csv('../../cleatmarkmethod/ecmdata/raw-data/patton-mocha-cleatmark-test-specimen-prep_2021-04-08/cleatmark-cyl-prep-QC_2021-04-08.csv', col_types = 'Dcccddcdddc') %>%
	left_join(tin_tares, by = c("tin_tare_set", "tin_number")) %>%
	left_join(soilmesh::chunk_cyl_dims, by = 'cylinder_ID') %>%
	soiltestr::add_w() %>%
	mutate(ambient_temp_c = 22,
				 Gs = Gs) %>%
	rename(empty_cylinder_mass_g = cyl_w_plug_mass,
				 cylinder_vol_cm3 = cyl_w_plug_volume) %>%
	soiltestr::add_physical_properties() %>%
	left_join(patton_mocha_metadata, by = c("experiment_name", "sample_name", "cylinder_ID")) %>%
	separate(sample_name, into = c('sample_name', 'effort'), sep = "-") %>%
	mutate(effort = if_else(
		effort == 'stdeff',
		'Standard',
		'Modified'),
		effort = factor(effort, levels = c('Standard', 'Modified')),
		sample_name = case_when(
			sample_name == 'mix01' ~ '60% sand',
			sample_name == 'mix02' ~ '75% sand'),
		replication = rep(1:3, times = 4),
		measurement_type = 'Prepared 6" cylinder'
	) %>%
	select(experiment_name, sample_name, effort, cylinder_ID,
				 water_content, dry_density, volumetric_water_content,
				 replication, measurement_type ) 

# fit fully crossed linear model 

qc_density_model <- cleatmark_qc_data %>% 
	lm(data =., formula = dry_density ~ sample_name * effort)

# check homogeneity of variance with Levene test 
# car::leveneTest(qc_density_model)

# looks great , p = 0.9

#  compute pooled standard deviation

pooled_qc_density_sd <- round(sigma(qc_density_model), 3)

# compute pairwise difference between cleat-mark density and corresponding proctor test 
# for the 4 soil x effort combinations 

proctor_test_results <- readr::read_rds(
  '../../cleatmarkmethod/ecmdata/derived-data/patton-mocha-cylinder-prep/patton-mocha-derived-proctor-values.rds'
) %>% 
  mutate(type  = 'proctor',
         dry_density = d_max,
         sample_name = if_else(
           sample_name == 'mix01',
           '60% sand',
           '75% sand'
         )) %>% 
  select(-c(d_max, w_opt))


mean_qc_density_values <- cleatmark_qc_data %>% 
  group_by(sample_name, effort) %>% 
  summarise(dry_density  = mean(dry_density),
            .groups = 'drop') %>% 
  mutate(type = 'qc')

density_diffs <- bind_rows(proctor_test_results, mean_qc_density_values) %>% 
  pivot_wider(values_from = dry_density, names_from = type) %>% 
  mutate(diff = proctor - qc)


avg_density_diff <- round(mean(density_diffs$diff), 2)

```


Figure \@ref(fig:proctor-vs-cleat-mark-achieved-density-fig) shows that the three replicates within a soil-by-effort pair were very consistent. The pooled standard deviation for a soil-by-effort combination was just `r pooled_qc_density_sd` Mg m^-3^.
Figure \@ref(fig:proctor-vs-cleat-mark-achieved-density-fig) also shows that the cleat-mark compaction routine packed the soil to a similar but systematically lower dry density than the corresponding Proctor tests.
This result agrees with other research on varying the mold diameter during compaction tests. 
@ASTMD698-12 states:

>"Results have been found to vary slightly when a material is tested at the same compactive effort in different size molds, with the smaller mold size typically yielding larger values of density/unit weight."

@Johnson1962 compacted a clayey sand in variously-sized molds. 
They reported a difference of 0.05 Mg m^-3^ between the 4" and 6" diameter molds.
This is very similar to the mean difference of `r avg_density_diff` observed in this small experiment.
The small decrease in dry density should be expected given the specimen size. 
Therefore, the energy conversion between the Proctor compaction mold and the cleat-mark cylinders was deemed valid. 


```{r proctor-vs-cleat-mark-achieved-density-fig, fig.cap='$\\rho_{bulk}$ achieved with the cleat-mark cylinders was consistent across replications and slightly lower than $\\rho$ derived from the corresponding Proctor curve.', fig.scap='$\\rho_{max}$ for cleat-mark cylinders c.f. Proctor testing'}
knitr::include_graphics('../../cleatmarkmethod/figs/pdf/proctor-vs-qc-density-comparison.pdf')

```


##### Trial run to compare compaction routines 

The next step in developing the specimen preparation routine was to determine whether the Standard or Modified routines would ultimately yield differences in the $\theta_{crit}$ value corresponding with the cleat-in/cleat-out behavioral threshold. 

Full trial runs of the cleat mark test were completed using each compaction routine. 
The full procedure for the will be detailed in Section \@ref(performing-cleat-mark-test).
A single critical water content $\theta_{crit}$ was derived for each soil-by-effort combination using the Normalized RFI as the surface metric of interest. 
These values are presented in Table \@ref(tab:derived-water-contents-from-cleat-mark-test-effort-comparison-tab).
These data suggest the compaction effort does not markedly influence the ultimate value determined for $\theta_{crit}$. The tests were not replicated so they cannot be statistically compared.


```{r derived-water-contents-from-cleat-mark-test-effort-comparison-tab, fig.cap="The critical volumetric water contents derived from the cleat mark test were nearly identical for the two compaction treatments.", eval=TRUE}
# hard-coding paths like this this is usually a no-no, but I am 
# doing it here to maintain the link between this table and the data
# and to do so without using something like make....the data lie in
# a totally separate prokect so I can't use relative paths from the project # root without navigating upward in my own computer's file system tree


# read and clean up data 
derived_test_values_from_compaction_pilot_data <- readr::read_rds('../../cleatmarkmethod/ecmdata/derived-data/cleaned-rds-files/disturbance-vs-water-content-cleaned-data.rds')

# derived_test_values_from_compaction_pilot_table <- derived_test_values_from_compaction_pilot_data$tidied_w_vals %>%
#   dplyr::filter(metric_label == 'dne') %>%
#   dplyr::ungroup() %>%
#   dplyr::select(sample_name, effort, volumetric_w_c) %>%
#   tidyr::pivot_wider(names_from = effort, values_from = volumetric_w_c) %>%
#   dplyr::mutate(sample_name = readr::parse_number(sample_name)) %>% 
#   dplyr::rename(Soil = sample_name) 
  

# set names of the columns;  must escape % symbol for Latex to parse correctly 
# colnames(derived_test_values_from_compaction_pilot_table) <- c("\\% Sand", "Standard", "Modified")
# 
# # set a vector for caption
# derived_test_values_from_compaction_pilot_table_caption <- "The critical volumetric water contents derived from the cleat mark test were nearly identical for the two compaction treatments."
# 
# # build kable 
# kableExtra::kbl(derived_test_values_from_compaction_pilot_table, 
#                 align = 'c',
#                 digits = 3, 
#                 format = 'latex', 
#                 booktabs = TRUE, 
#                 escape = FALSE,
#                 position = 'htbp',
#                 caption = derived_test_values_from_compaction_pilot_table_caption,
#                 caption.short = "$\\theta_{crit}$ values from cleat mark test performed with 2 compaction efforts") %>% 
#   kableExtra::add_header_above(header = c(" " = 1, "$\\\\theta_{crit}$" = 2), escape = FALSE) %>% 
#   kableExtra::kable_styling(position = 'center')


derived_test_values_from_compaction_pilot_table <- derived_test_values_from_compaction_pilot_data$tidied_w_vals %>%
  dplyr::filter(metric_label == 'dne') %>%
  dplyr::ungroup() %>%
  dplyr::select(sample_name, effort, volumetric_w_c) %>%
  tidyr::pivot_wider(names_from = sample_name, values_from = volumetric_w_c) %>%
  dplyr::rename(Effort = effort) %>% 
  dplyr::rename_with(.cols = where(is.numeric),
                     .fn = ~stringr::str_replace(., "%", "\\\\%")
  )
  

# set a vector for caption

derived_test_values_from_compaction_pilot_table_caption <- "The critical volumetric water contents derived from the cleat mark test were nearly identical for the two compaction treatments."
 
# # build kable 
kableExtra::kbl(derived_test_values_from_compaction_pilot_table,
                align = 'c',
                digits = 3,
                format = 'latex',
                booktabs = TRUE,
                escape = FALSE,
                position = 'htbp',
                caption = derived_test_values_from_compaction_pilot_table_caption,
                caption.short = "$\\theta_{crit}$ values from cleat mark test performed with 2 compaction efforts") %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>% 
  kableExtra::add_header_above(header = c(" " = 1, "$\\\\theta_{crit}$" = 2), escape = FALSE, bold = TRUE) %>% 
  kableExtra::kable_styling(position = 'center')


```

##### Summary - specimen compaction

The Modified effort was ultimately adopted for all further study.
This choice is justified by the following:

1. The "critical" water contents derived from the two methods were very similar (Table \@ref(tab:derived-water-contents-from-cleat-mark-test-effort-comparison-tab)). No statistical comparison was made but the differences due to soil type appears to be larger than any difference due to compaction effort. 

2. Soil bulk density on an actual infield was higher than that obtained from a Standard Proctor test, but lower than that obtained from a Modified Proctor test (Figure \@ref(fig:proctor-vs-observed-infield-density)). 
The prevailing view among baseball grounds managers is that the infield should be as compacted as possible. 
Therefore, a realistic lab test should favor greater rather than lesser compaction.




#### Performing the test {#performing-cleat-mark-test}


There are four basic steps in the cleat-mark test:

1. Produce cleat indentations on the specimen

2. Collect a 3D scan 

3. Measure the water content and some additional features of the sample.

4. Repair the specimen for subsequent tests

##### Cleat indentations 

The pneumatic device is first charged to 690 kPa (100 psi).
The specimen is secured into the device with adjustable clips. 
The device is manually actuated and then retracted. 
Any soil ejected from the cleat indentations is carefully removed so that the clods are not crushed by subsequent tests.
This sequence is repeated twice more, rotating the specimen by 60    &deg; after each test.
The reserved soil clods are carefully replaced at their original locations.

##### 3D scan {#cleat-mark-specimen-3D-scanning}

Six markers are placed on the rim of the aluminum sample holder (Figure \@ref(fig:scanner-markers)). 
The markers allow the scanner to register each pointcloud and merge them into a single mesh.
A series of scans is made using a step size of 20&deg; for a total of 18 captures per specimen. 
<!-- Surface texture is not recorded as this nearly triples the scan time and does not contribute useful information during later analyses. -->
These are merged using EinScan's software (without scaling or reduction) and exported as a single `.ply` file.
The `.ply` format is an open file format and supports both ASCII and binary encoding [@Turk1994]. 
<!-- It was designed to be simple yet extensible: while the only requirements are a set of x, y, and z vertex coordinates and corresponding face indices, arbitrary information such as color and texture may be also be encoded directly alongside the spatial coordinates [@Turk1994]. -->


##### Water content and ancillary data 

Representative values of $w$ and $\theta$ are determined using the procedure detailed in Section \@ref(sand-replacement-vs-scanner-for-theta).

Penetrometer resistance is measured with a handheld device having a maximum capacity of 5 kg cm^-1^. 
Four readings are averaged to produce a a representative value. 
Dry specimens tend to reject this device, so in these cases peak resistance cannot be recorded. 
Visual observations on the nature of deformation are noted. 
Finally, a digital photograph of the sample is taken after the test.

#### Specimen repair

Several data points are needed to define $\theta_{crit}$.
The samples are wetted and allowed to cure overnight. 
The cleat indentations are then repaired with soil pre-wetted to $w_{opt}$.
This procedure effectively refreshes the surface to its initial state. 
The repairs are made with a routine similar to that used on real infields. 
Figure \@ref(fig:daily-specimen-repair-panels) shows this process. 


(ref:daily-specimen-repair-panels-caption) \textbf{A.} The soil is scarified to a depth of 20 mm to facilitate binding with the new material. \textbf{B.} Additional material is added and compacted with a Proctor hammer. \textbf{C.} The soil is planed to the specimen rim with a straight edge. \textbf{D.} The specimen is thoroughly wetted before repeating the drydown procedure described in Section \@ref(measuring-and-adjusting-water-content).


```{r daily-specimen-repair-panels, fig.cap='(ref:daily-specimen-repair-panels-caption)', fig.scap='Repair proces for cleat-mark specimens'}

knitr::include_graphics('figs/png/daily-specimen-repairs-panels.png')

```

#### Measuring & adjusting the water content {#measuring-and-adjusting-water-content}

Wetting and drying cycles are an important part of infield behavior. 
<!-- this is a good thing to mention but this is the wrong place for it -->
<!-- A heavy hand-watering is usually the first action taken following grading and compaction.  -->
<!-- Evacuating air from the profile aids in settling the soil to a stable condition. -->
The brittle-ductile transition mostly occurs during day games when no water can be added after the game begins. 

A given soil must be tested at a range of water contents which bracket $\theta_{crit}$. 
In our lab test, the water content was adjusted up or down by adding a known volume of water or by drying under a heat lamp manifold. 
The manifold was calibrated to emulate the outdoor conditions on a summer day in the northeastern United States.
Figure \@ref(fig:heat-lamps-photo) shows the apparatus which comprises 12 clamp fixtures on 60 cm spacing. Each fixture houses a 150-W broad-spectrum incandescent bulb (Exo-Terra PT2114 - A21/150W). 


Proper configuration of the drying apparatus was determined through a series of calibrations.
These measured the effect of lamp distance, the variability in water content within and across specimens, and the validity of two methods for measuring $\theta$.
These are next described. 


###### Water content study 1: Lamp distance 

The goal of this experiment was to determine the proper distance between the heat source and the soil surface. 
Gravimetric water content $w$ was determined in the top 15 mm using an 8 mm diameter soil probe.
Four samples were extracted each hour and averaged to produce a representative value for the surface.
The surface temperature was also recorded using an infrared laser thermometer. 
The first 3-4 hours of drying are of greatest interest be cause this is the typical length of a professional baseball game.

Figure \@ref(fig:water-content-change-by-lamp-height) A shows that the distance between the heat bulb and the soil specimen markedly affects the drying rate. 
A 15 cm distance caused excessively rapid drying (initially over 3 % by dry mass hr^-1^). 
Figure \@ref(fig:water-content-change-by-lamp-height) B also shows the rate of water loss was not constant with time. 
Water loss was most rapid during the first &thickapprox; 2.5 hours before tapering off.
This is a well-documented phenomenon in soil physics and often corresponds with the breaking of continuous capillary flow [@Radcliffe2010].

At the other extreme, the 45 cm lamp height produced only a small change in water content over several hours. 

```{r compute-delta-w-for-lamp-heights}

w_30cm_3_hr <- readr::read_rds('../../cleatmarkmethod/ecmdata/derived-data/cleaned-rds-files/summer-2020-drydown-calibration-cleaned-data.rds') %>% 
  dplyr::filter(lamp_ht_cm == 30L,
              as.character(sample_time) %in% c('2020-06-01 08:45:00', '2020-06-01 11:30:00'),
                # dry_time_sec == 0 || dplyr::near(dry_time_sec, 13500),
                stringr::str_detect(lamp_type, 'Exo-Terra')) %>%
  dplyr::select(sample_time, water_content) %>% 
  # dplyr::mutate(dry_time = sample_time - min(sample_time)) %>% 
  dplyr::group_by(sample_time) %>% 
  dplyr::summarise(water_content = mean(water_content)) %>% 
  purrr::pluck('water_content')

delta_w_30_cm_3_hr <- (max(w_30cm_3_hr)- min(w_30cm_3_hr)) %>% 
  signif(3)

```


The 30 cm distance produced the most realistic result. 
$\Delta_w$ was `r delta_w_30_cm_3_hr` over the first 2.75 hr.
Figure \@ref(fig:lamp-height-calibration) shows that the surface temperature observed beneath the 30 cm lamp height compared favorably with that of an actual infield on a sunny August day in Pennsylvania. 



```{r heat-lamps-photo, fig.cap='Drydown manifold used prior to cleat-mark test.'}
knitr::include_graphics('./images/heat-lamps.JPG')
```



```{r lamp-height-calibration, fig.cap='Surface temperature for the 30 cm lamp height closely matches conditions observed on a sunny day in Pennsylvania (outdoor photo credit: Andrew Burnette)', fig.scap='Temperature beneath drydown apparatus c.f. outdoor conditions', eval=TRUE}

knitr::include_graphics('../../cleatmarkmethod/figs/manually-built/drydown-surface-temp-comparison.png')

```
 
 
 
```{r water-content-change-by-lamp-height, fig.cap='\\textbf{A.} Water loss was most significant for the 15 cm height. \\textbf{B.} The first derivative of $w$ with respect to time shows the rate of water loss changed rapidly for the lowest lamp height. The 30 and 45 cm heights lost water at a steadier rate.', fig.scap='Changes in total $w$ and evaporation rate with time', eval=TRUE}

# set theme
theme_set(theme_classic())

# import both figures and combine as a patchwork 
water_loss_figs <- list.files('../../cleatmarkmethod/figs/rds/',
                   pattern = 'water-loss.*2020',
                   full.names = T) %>% 
  rev() %>% 
  purrr::map(readr::read_rds)


water_loss_patchwork <- water_loss_figs %>% 
  wrap_plots()+
  theme(legend.position = 'none')+
  patchwork::plot_layout(guides = 'collect')+
  patchwork::plot_annotation(tag_levels = 'A',
                  tag_suffix = '.') &
  theme(plot.tag = element_text(size = 16))


print(water_loss_patchwork)

```
 

###### Water content study 2: Uniformity across specimen surface and across replicate specimens

The cleat-mark test pairs a single water content value with a surface disruption measurement. 
In water content study (1), $w$ was assumed to be equal across the specimen surface. 
A second experiment was performed to verify this assumption.

As for water content study (1), $w$ was determined in the top 15 mm using an 8 mm diameter soil probe. 
A 40-mm grid was marked on three replicate specimens. The samples were placed under the drying apparatus and a soil sample was removed at each grid intersection every 60 minutes (Figure \@ref(fig:water-content-grid-photo)). 
This allowed comparison of $w$ across both space and time.


Figure \@ref(fig:w-variation-across-space-and-time) shows the results for each replicate during the 6-hr drying period.
The water content was highly uniform across the surface of a single specimen, and the difference across replications was small. 
Therefore, it is reasonable to consider the water content horizontally uniform for a single specimen. 

<!-- The variation in water content due to time is clearly larger than any heterogeneities across an individual specimen or across replications.  -->
 
```{r water-content-grid-photo, fig.cap='Grid sampling for water content study (2).'}

grid_sampling_panels_path <- 'images/w-grid-sampling.png'

# create file if it has not been built or gets accidentally deleted
if(!file.exists(grid_sampling_panels_path)) {

  magick::image_read(c('../../cleatmarkmethod/photos-and-screen-recordings/w-variation-grid-01.JPG',
             '../../cleatmarkmethod/photos-and-screen-recordings/w-variation-grid-02.JPG')) %>% 
    magick::image_border(color = 'white', geometry = "20x20") %>% 
  magick::image_append() %>% 
    magick::image_write(grid_sampling_panels_path)
  
}
# this is to label them, but I don't think it's necessary 
# image_border('white') %>% 
  # image_annotate(text = paste0(LETTERS[1:2], '.'), strokecolor = 'black', size = 350, color = 'white', location = '+150+150')

knitr::include_graphics('images/w-grid-sampling.png')


```


```{r w-variation-across-space-and-time, fig.cap='$w$ was consistent across the surface of a single specimen and across replicate cylinders.', fig.scap='Spatial and temporal variation of $w$ for cleat-mark cylinders', eval=TRUE}

knitr::include_graphics('figs/pdf/w-variation-across-space-and-time.pdf')

```





###### Water content study 3: Precise measurement of $\theta$ {#sand-replacement-vs-scanner-for-theta}
The third water content study's aim was to develop a method for measuring _volumetric_ water content $\theta$. 
Relative merits of $w$ and $\theta$ are discussed in Section \@ref(soil-water-content) and by @Brady2007. 
In the present study it is far easier to measure $w$ on the small samples available for testing. 
However, it is the volume of water which determines the spacing of soil particles and the nature of their contacts.
Also, $\theta$ is more commonly in use among grounds managers because it can be measured in-situ on an actual infield with a time-domain reflectometry probe.
It would be preferrable to use $\theta$ over $w$ if it can be precisely measured.
Therefore a method was sought to measure $\theta$ using small samples.
The goal was to compute $\theta$ as $w \cdot \rho_{bulk}$.

A small intact soil core was removed (diameter = 21mm, depth = 15 mm) using a soil probe (Figure \@ref(fig:mini-density-panels)).
The core is ejected with a plunger and immediately weighed to &plusmn; 0.001 g. 
The bottom of the core normally separates in an uneven pattern, so a simple geometric computation
of the cylinder's volume is not possible.
Two methods were employed to measure the volume of the plug:

(1.) Sand replacement

(2.) 3D scanning

<!-- ```{r build-mini-density-panels} -->
<!-- probe_path <- '../../cleatmarkmethod/photos-and-screen-recordings/mini-density/04-sample-probe.JPG' -->

<!-- top_panel <- probe_path %>%  -->
<!--   magick::image_read() %>%  -->
<!--   magick::image_annotate(text = paste0("A", '.'), size = 500, location = magick::geometry_point(200,0), color = 'white', strokecolor = 'black') %>% -->
<!--   magick::image_border(color = 'white', geometry = '20x20') %>%  -->
<!--   magick::image_resize('400x') -->



<!-- # read images and combine/annotate with magick, then write composite to disk -->
<!-- sand_cone_method_path <- '../../cleatmarkmethod/photos-and-screen-recordings/mini-density/02-sand-cone-fill.JPG' -->

<!-- scanner_method_path <- '../../cleatmarkmethod/photos-and-screen-recordings/mini-density/03-tack-skewered-plug.JPG' -->


<!-- bottom_panels <- magick::image_read(c(sand_cone_method_path, scanner_method_path)) %>% -->
<!--   magick::image_annotate(text = paste0(c("B","C"), "."), size = 500, location = magick::geometry_point(200,0), color = 'white', strokecolor = 'black') %>% -->
<!--   magick::image_border(color = 'white', geometry = '20x20') %>%  -->
<!--   magick::image_resize('400x') %>%  -->
<!--   magick::image_append() -->

<!-- ``` -->


```{r mini-density-panels, fig.cap='Measuring the volume of a 15 mm-deep by 21 mm diameter soil plug: \\textbf{A.} Miniature soil probe and plunger. \\textbf{B.} Sand replacement method with an inverted cone. \\textbf{C}. 3D scanning method with plug situated on a rest to provide clearance from turn table.', fig.scap='Measuring the volume of miniature soil plugs',, out.width='95%'}

mini_density_panels_output_path <- 'figs/png/mini-density-combined-panels.png'

if(!file.exists(mini_density_panels_output_path)){
# read images and combine/annotate with magick, then write composite to disk

probe_path <- '../../cleatmarkmethod/photos-and-screen-recordings/mini-density/04-sample-probe.JPG'


sand_cone_method_path <- '../../cleatmarkmethod/photos-and-screen-recordings/mini-density/02-sand-cone-fill.JPG'

scanner_method_path <- '../../cleatmarkmethod/photos-and-screen-recordings/mini-density/03-tack-skewered-plug.JPG'

all_3_panels <- magick::image_read(c(probe_path, sand_cone_method_path, scanner_method_path)) %>%
  magick::image_annotate(text = paste0(c("A", "B","C"), "."), size = 500, location = magick::geometry_point(200,0), color = 'white', strokecolor = 'black') %>%
  magick::image_border(color = 'white', geometry = '20x20') %>% 
  magick::image_append()

all_3_panels %>% 
  magick::image_write(mini_density_panels_output_path)

}

knitr::include_graphics('figs/png/mini-density-combined-panels.png')
```



Method (1) was essentially a miniature version of ASTM D1556 [-@ASTMD1556-07]. 
A small plastic cone was trimmed and its volume was carefully calibrated with de-aired water.
A dry sand was calibrated to  loose density of 1.54 Mg m^-3^.
These were used to fill the cavity left by the soil plug (Figure \@ref(fig:mini-density-panels) B).
The plug volume was calculated from the mass of sand used to fill the hole and the known cone volume:

\begin{align}
\quad V_{plug} &= V_{sand_{~total}} - V_{cone} \quad ; \quad V_{sand_{~total}} = \frac{m_{sand_{~total}}}{\rho_{sand}} \\
V_{plug} &= \frac{m_{sand_{~total}}}{\rho_{sand}} - V_{cone}
(\#eq:mini-density-sand-backfill-equation)
\end{align}

In method (2), a 3D scan of the core was recorded (Figure \@ref(fig:mini-density-panels) C). 
3D scanning has been used to measure bulk density for irregularly-shaped soil clods [@Rossi2008]. The scanning process was similar to that described for the actual cleat-mark test (Section \@ref(cleat-mark-specimen-3D-scanning)).
The primary difference was that for the water content plug scan, two scans were recorded with the plug in different orientations.
This was required for all sides to be "seen" by the scanner.
An additional challenge was raising the specimen above the turntable so it would register separately from the turntable. 
Ultimately the plug was stationed atop a #10 U.S. hex nut. This resting space provided enough clearance so the soil could be differentiated from the turntable while maintaining a stable orientation. 
The volume of the plug was determined using the `vcgVolume()` function in the **`Rvcg`** software package for R [@Schlager2017]. 


For both plug volume methods, a $\theta$ value was computed from the specimen's gravimetric water content and its dry density:

\begin{align}
% \text{Gravimetric water content:}  \nonumber  \\ 
w &= \frac{water~loss~(g)}{m_{oven-dry~soil}~(g)} \\
% \text{Dry bulk density:}  \nonumber  \\
\rho_{bulk} &= \frac{m_{oven-dry~soil}~(g)}{core~volume~(cm^3)} \\
% \text{Volumetric water content:} \nonumber \\
\theta  = \rho_{bulk} \times w &= \frac{water~loss~(g)}{m_{oven-dry~soil}~(g)} \times \frac{m_{oven-dry~soil}~(g)}{core~volume~(cm^3)}
(\#eq:vwc-equation) 
\end{align}


<!-- have to put this chunk first so values are available for reference  -->


```{r compute-values-for-sand-replacement-vs-scanner-vol, eval=T}
# read data frame  
sand_backfill_vs_scanner_vol_data <- readr::read_rds(fs::path(
  '../../cleatmarkmethod/ecmdata/derived-data/cleaned-rds-files/mini-plug-density-comp-cleaned-data.rds') ) %>% 
  mutate(vol_method = factor(vol_method))


# head(sand_backfill_vs_scanner_vol_data)

mod <- lm(data = sand_backfill_vs_scanner_vol_data,
       formula = dry_density ~ vol_method * cylinder_ID)

# check assumption of homogeneity of variance with Levene test 

# car::leveneTest(mod)
# p-vlue is 0.133 so can assume equal variance 


# compute pooled standard deviation for each 
# group independently 
mini_density_scanner_vol_sd_vals <- sand_backfill_vs_scanner_vol_data %>% 
  split(sand_backfill_vs_scanner_vol_data$vol_method) %>% 
  map(lm, formula  = dry_density ~ cylinder_ID) %>% 
  map_dbl(sigma)

scanner_rho_sd <- mini_density_scanner_vol_sd_vals[["3D scanner"]] %>% round(2)
sand_replacement_rho_sd <- mini_density_scanner_vol_sd_vals[["Sand displacement"]] %>% round(2)

# compute average inrease in rho from one sand replacement method 
# to scanner method 
avg_diff_between_sand_replacement_and_scanner_rho <-
  sand_backfill_vs_scanner_vol_data %>% 
  group_by(cylinder_ID, vol_method) %>% 
  summarise(mean = mean(dry_density)) %>% 
  pivot_wider(names_from = vol_method, values_from = mean) %>% mutate(avg_diff = `3D scanner` - `Sand displacement`) %>%
  pluck('avg_diff') %>% 
  mean() %>% 
  round(3)
  


# just to reassure myself these values are correct, 
# compute sigma for the whole model
# sigma(mod)
# mean(mini_density_scanner_vol_sd_vals)
# they are not idenical but close enough toe make me feel
# confident this is correct....probably they are not identical due to some 
# mathematics re: the squaring and averaging. 
# 


# compute summary tibble 
sd_df <-  sand_backfill_vs_scanner_vol_data %>% 
  dplyr::group_by(cylinder_ID, vol_method) %>% 
  dplyr::summarise(dplyr::across(dry_density, 
                                 list(mean = mean, sd = sd), 
                                 .names="{.fn}"),
                   .groups = 'drop')
# compute some values from the table for use in dynamic references 


```


5 replicate soil plugs were analyzed on each of the 12 prepared cleat-mark specimens.
Mean values and standard deviations were computed for each method; these data are plotted in Figure \@ref(fig:sand-backfill-vs-3D-scanner-for-volumetric-w-determination-fig) and the values are compiled in the Appendix (Table \@ref(tab:sand-backfill-vs-3D-scanner-for-volumetric-w-determination-table)).

(ref:sand-backfill-vs-3D-scanner-for-volumetric-w-determination-fig-caption) The 3D scanning method for computing the extracted plug's volume 
```{r sand-backfill-vs-3D-scanner-for-volumetric-w-determination-fig, fig.cap='(ref:sand-backfill-vs-3D-scanner-for-volumetric-w-determination-fig-caption)', eval=TRUE}
knitr::include_graphics('../../cleatmarkmethod/figs/pdf/mini-plug-density-comp.pdf')
```
Figure \@ref(fig:sand-backfill-vs-3D-scanner-for-volumetric-w-determination-fig) shows improved precision with the scanner method.
The standard deviation $\sigma_{\rho}$ for a single specimen was `r sand_replacement_rho_sd` when measured with sand replacement, but only `r scanner_rho_sd` when measured with the scanner. 
Therefore, computing $\rho$ with the 3D scanning method reduces error propagation in $\theta$.
As an example, if the true value for $w$ is 15%, the consequence of one standard deviation of 0.07 Mg m^-3^ in the density measurement propagates to a $\theta$ error of `r round(sand_replacement_rho_sd*0.15, 3)`. This would appear unacceptably large if the cleat-mark analysis is to pinpoint $\theta_{crit}$ within < 1 % accuracy. 

Interestingly, the scanner method produced not only less scatter but also higher mean $\rho_{bulk}$ for 11 of the 12 cylinders. 
The average difference was `r  avg_diff_between_sand_replacement_and_scanner_rho` Mg m^-3^. Most likely the probe produces some plastic distortion of the hole's sidewalls when it is inserted and removed. 
This additional space is filled by sand which increases the measured volume and decreases the computed dry density. 
Also, for this small sample diameter the probe's sidewalls (0.5 mm) comprise a non-negligible fraction of the total hole's volume. 
Again, this volume is considered part of the plug volume for the sand replacement method but not for the scanner method. 

The scanner method directly measures the volume of the soil plug, so it more accurately represents the soil sample's true dimensions. 
Intact core sampling is often assumed to produce some compaction in the sidewalls as the probe is driven into the surface [@Lichter1994]. 
These samples are already intentionally compacted to a high degree so the sidewall compaction effect is probably minor. 

<!-- In summary, the 3D scanner method for determining $\rho$ showed good precision.  -->
<!-- Its small standard deviation of `r scanner_rho_sd` warrants the use of a single plug to represent the density of the cleat-mark specimen.  -->
<!-- Additional small gravimetric samples will be taken as these are less destructive and can be processed rapidly to further reduce the uncertainty around $\theta$. -->



###### Summary: measuring and adjusting water content 

A routine was developed to wet and dry the samples in a controlled manner. 
A set of heat lamps dries the surfaces uniformly across space. 
$\theta$ can be measured with good precision and accuracy by using a combination of gravimetric methods and 3D scanning. 

#### Mesh processing pipeline 

In their raw state, the `.ply` files are of little use because their coordinates are relative to the scanner's detector, not a "real-world" coordinate system.
They also contain incomplete fragments of the aluminum specimen holder.
Figure \@ref(fig:orienting-and-removing-cyl-fig) A shows the raw mesh in "real-world" coordinates immediately following the scan acquisition.
A number of cleaning and processing operations are required before collecting any surface measurements. 



Mesh processing may be done interactively with point-and-click software such as MeshLab [@Cignoni2008], but this interactive approach does not scale to large numbers of meshes and it is subject to human error.
Instead, a processing routine was developed using the R Language for Statistical Computing [@R-core2021].
The routine is stored in the author's **`soilmesh`** package (<https://github.com/evanmascitti/soilmesh>).
**`soilmesh`** is primarily based on the **`Rvcg`** and **`Morpho`** packages [@Schlager2017], which are in turn built atop the open-source C++ libraries maintained by the ISTI-CNR Visual Computing Lab (Pisa, Italy, <https://www.isti.cnr.it/en/>).
<!-- This is out of place but landmark shape analysis needs to be mentioned _somewhere_ -->
<!-- Like most tools for 3D meshes, these packages are geared toward landmark shape analysis.  -->
<!-- **Landmarks** are analagous points across specimens, for example the tip of one's nose.  -->
<!-- Landmarks are usually digitized manually and used to align specimens, but there is no need for an absolute coordinate system.  -->
A 4x4 roto-translation matrix was interactively recorded using a freshly prepared specimen. 
This 4x4 matrix was saved as an `.rda` data file and applied to each mesh using implicit loops (functionals).
Figure \@ref(fig:orienting-and-removing-cyl-fig) B) shows the corrected orientation of the mesh. 

The mesh was then finely adjusted in the x-y plane based on its maximum x and y coordinate values. 
This step is required because it is impossible to place each successive specimen in an _identical_ location on the turntable. 
Next, any points greater than 70 mm from the mesh's center were removed by computing Boolean values for each vertex solved from the basic equation for a circle with origin $(0,0)$  :

\begin{align}
		\begin{split}
			(x - h)^2 + (y - k)^2 &= r^2 \\
			\mathrm{Since}~x=0~\mathrm{and}~y=0;~~ (x - 0)^2 + (y - 0)^2 &= 70^2 \\
			x^2 +y^2 &= 70^2 \\
		\end{split} 
(\#eq:cylinder-clipping-equation) 
\end{align}

Therefore for a given vertex, if $x^2+y^2>70^2$ the vertex was removed from the matrix of coordinates. 
This step "trimmed" both the aluminum sample holder and the outer rim of the specimen's surface, leaving a disk 140 mm in diameter (Figure \@ref(fig:orienting-and-removing-cyl-fig) C). 

After removing the cylinder a final adjustment was made to the mesh's z-coordinates. 
Fine-grained soil may change volume as it wets or dries.
The change is not necessarily planar; the center of the sample often shrinks faster than the edges. 
These small changes in surface elevation mean that a single rigid 4x4 matrix cannot return the "origin" of every sample to the exact coordinates $(0, 0, 0)$.
However, it could be assumed that _on average_ the elevation with the greatest frequency of points represents the elevation of the original soil surface at test time.
This assumption was used to perform the final z-adjustment.
The distribution of z-coordinates (comprising ~2.5 million points) was split into 10,000 bins. 
The most frequently occurring value was assumed to be the "true" level of z=0. 
Each point in the mesh was moved up or down by this value, depending on its sign  (Figure \@ref(fig:mesh-z-points-histogram)).

```{r mesh-z-points-histogram, fig.cap='Each vertex of the mesh was adjusted by the median elevation to further refine the position of the mesh.', fig.scap='Final adjustment of mesh z-coordinates'}
knitr::include_graphics('../../cleatmarkmethod/figs/pdf/z-histogram.pdf')
```


The result of the orientation, cleaning, and decimation operations is shown in Figure \@ref(fig:orienting-and-removing-cyl-fig) C.
The "origin" of the mesh lies within a fraction of 1 mm from $(0, 0, 0)$.


(ref:orienting-and-removing-cyl-caption) \textbf{A.} Orientation of the raw mesh generated by 3D scanner. \textbf{B.} Orientation of the specimen after application of 4x4 roto-translation matrix. \textbf{C.} Final orientation of mesh after removing extraneous portions and performing secondary position adjustments. Junction of the three axes represents $(0,0,0)$.

```{r orienting-and-removing-cyl-fig, fig.cap = '(ref:orienting-and-removing-cyl-caption)', fig.scap='Mesh orientation and cleaning pipeline'}
knitr::include_graphics('../../cleatmarkmethod/figs/manually-built/processing-pipeline-panel.png')
```

##### Mesh size reduction

The final step in the pre-processing routine is to reduce the size of the `.ply` file. 
Landscape-scale research has shown that large pointclouds often have resolution exceeding that required for robust analyses [@Brubaker2013]. 
In such a case, it is pragmatic to reduce the file sizes for easier storage and better computational efficiency. 

A decimating "titration" was performed on several meshes to determine how much the mesh size could be reduced without sacrificing detail.
Figure \@ref(fig:decimation-titration-surface-area) shows that for a raw mesh file with > 3 million faces, little loss in surface area occurred until the mesh was reduced to &thickapprox;100,000 faces. 
A face number of 500,000 was chosen to include a factor of safety.


```{r decimation-titration-surface-area, fig.cap='Meshes were decimated to 500,000 faces (red vertical line) to impove computational efficiency without a loss in data quality.', fig.scap='Mesh decimation to reduce file size.'}
knitr::include_graphics('../../cleatmarkmethod/figs/pdf/surface-area-by-faces-titration.pdf')
```



##### Summary: mesh processing pipeline

The processing routine is a substantial advance compared with point-and-click alternatives.
By performing the mesh processing programatically, time is saved and the results are made operator-independent. 


#### Surface metrics 

A primary goal of baseball grounds managers is to minimize  disturbance to the infield skin during play. 
In the cleat-mark test, several measurements have been developed to enumerate the degree of disturbance to the soil surface.
All are conceptually referenced to an undisturbed soil surface of the same radius, lying in the $(x, y)$ plane (Figure \@ref(fig:ref-circ-plane-fig)).

```{r ref-circ-plane-fig, out.width='50%', fig.cap='3D mesh of undisturbed soil surface centered at $(0,0,0)$', fig.scap='3D mesh of undisturbed soil surface'}
knitr::include_graphics('figs/png/ref-circ-plane.png')
```

Figure \@ref(fig:example-meshes-panels) shows the range of surface conditions produced during the test. 
These three meshes were produced from the same soil at different water contents. 

```{r example-meshes-panels, fig.cap='(Top to bottom): Examples of surfaces with high, moderate, and low surface disruption. Meshes in a row are equivalent. Colors at right are mapped to the points\' z-coordinates, with red areas lying above the reference plane and blue areas below.', fig.scap='Example 3D meshes after testing.'}
knitr::include_graphics('../../cleatmarkmethod/figs/png/example-high-medium-low-surface-area-meshes.png')
```


The measurements are grouped into three categories:

**Surface metric group 1.** Volume of disturbed soil

Effectively these are the "cut" or "fill" required to return the tested sample to its originally planar state. Several algorithms were developed to compute these values from the pointcloud (voxel-based sampling, rasterization, and full re-meshing).

```{r volume-slicing-fig, fig.cap='Soil volume was computed for portions of the mesh lying either above or below the reference datum.', fig.scap='3D mesh split by vertex elevations'}
knitr::include_graphics('../../cleatmarkmethod/figs/png/top-view-plan-view-combined.png  ')
```


Mesh-generated volumes were compared with a physical analog method. 
Volume above the datum was computed by collecting any disturbed clods from the soil surface. 
If no clods were ejected, material which was plastically deformed above the cylinder rim was shaved off with a metal rule.
The supra-datum soil was oven-dried and weighed, and supra-datum volume was computed from its oven-dry mass and $\rho$.

The sub-datum volume was computed using a sand-backfill method similar to ASTM D-1556 [-@ASTMD1556-07].
The depressions were back-filled with dry sand of known $\rho$ and the volume was computed from the mass of sand used to fill the depressions (Figure \@ref(fig:cleat-mark-sand-backfill-panel)).


```{r cleat-mark-sand-backfill-panel, fig.cap='Manual sand-backfilling method for computing sub-datum volume.', fig.scap='Sand backfill method for cleat-mark volume'}

cleat_mark_sand_backfill_imgs <- list.files(path = '../../cleatmarkmethod/presentations/photos/cleat-mark-measurements/', full.names = T)

panel_output_path <- 'figs/png/cleat-mark-sand-backfill-panel.png'

if(!file.exists(panel_output_path))
magick::image_read(cleat_mark_sand_backfill_imgs) %>% 
  magick::image_border(color = 'white') %>% 
  magick::image_append() %>% 
  magick::image_write(panel_output_path)
  
knitr::include_graphics(panel_output_path)
```




**Surface metric 2.** Normalized Relief Index (NRFI)

This is the simplest of the measurements - it is a normalized ratio of the triangular mesh's 3D surface area to its 2D footprint. 
The surface area of the reference plane is subtracted and the result is multiplied by 100 to make the values simpler to compare. 
NRFI is essentially the percent gain in surface area for the tested specimen over its undisturbed equivalent. The formula is: 

\begin{equation}
NRFI = \left(\frac{\text{surface area}_{\text{ total}}}{\pi~r^2} - \pi~r^2 \right) \times 100 \\
(\#eq:nrfi-equation) 
\end{equation}


**Surface metric 3.** Dirichlet Normal Energy (DNE)

Dirichlet Normal Energy is a more complex morphometric used in anthropology and biology. 
In particular, it has been used to quantify surface roughness of primate dentition [@Bunn2011].
DNE is a measure of the total curvature of a surface: a horizontal plane has  DNE of zero.
For each point on a surface, DNE computes two principal curvatures and compares them with a plane oriented perpendicular to the vertex normal.
For regular geometries (such as a sphere) the total DNE is integrable, but for irregular surfaces a discretization is required.
The `molaR` package for R [@Pampush2020] computes DNE from `.ply` meshes.
The discretization is performed by using the face normals rather than vertices.
The DNE value for each face is multiplied by its surface area and these values are summed to produce a whole-surface value. 
See @Pampush2016 and @Bunn2011 for a more detailed treatment of DNE.

#### Determination of $\theta_{crit}$

The goal of the cleat-mark test is to identify a single water content where the soil exhibits an abrupt change between brittle and ductile behavior. 

<!-- some extra lingo I took out -->

<!-- It is useful to have a single characteristic value to compare infield mixes.  -->

<!-- In most cases the transition is rather abrupt. sufficiently abrupt to assign a single value.   -->

<!-- In reality the brittle-ductile transition occurs somewhat more gradually. -->

Each surface metric was plotted against volumetric water content.
For this discussion NFRI is referenced as the metric of choice, but the general shape of the relationship is similar for other metrics.
Figure \@ref(fig:example-nfri-vs-water-content-curve) shows an example curve. 
A third-order polynomial regression was fitted to a plot of NFRI against $\theta$.
The critical water content $\theta_{crit}$ was identified as the first local minimum as the soil moves from wet to dry (right to left on Figure \@ref(fig:example-nfri-vs-water-content-curve)).

(ref:example-nfri-vs-water-content-curve) An example of the characteristic water contents used to derive $\theta_{crit}$. Water contents above point A generally yield little additional disturbance. Water content B represents the state in which the soil is most 'vulnerable' to fragmentation. As water content reduces further toward point C, the soil hardens and the cleats are less able to penetrate the surface. 

The choice of this point as $\theta_{crit}$ warrants a brief discussion behind the physical meaning of the curve's shape.

```{r example-nfri-vs-water-content-curve, fig.cap='(ref:example-nfri-vs-water-content-curve)', fig.scap='Conceptual stages of infield soil behavior with reducing $\\theta$'}

knitr::include_graphics('./figs/pdf/example-w-crit-curve.pdf')

```




When the soil is very wet, the device easily actuates to the full extent afforded by its geometry. 
Further increases in the water content can only produce a marginally greater disruption to the specimen. The NRFI vs. $\theta$ curve is relatively flat. 

At lower water contents, disturbance is relatively constant because no soil is removed or fractured from the surface. 
Any new surface area is governed purely by the shape of the cleats. 
This is an ideal state from the perspective of the grounds manager. 

When the soil reaches $\theta_{crit}$ it begins to fragment into discrete pieces as the cleats penetrate the surface. 

As the soil continues to dry, brittleness is maximized and the soil forms larger chips and clods. 
These may fragment further which produces additonal surface area. 

A possible complication not depicted in Figure \@ref(fig:example-nfri-vs-water-content-curve) is that with further decreases in water content the soil becomes so hard that NFRI falls below its value at $\theta_{crit}$.
Although NFRI is nominally lower in this state, the soil is in an undesirable condition because of its high strength.
Ball response will be erratic and players can incur injuries due to extreme surface hardness.
For this reason, any points drier than the local maximum marked as point (B) in Figure \@ref(fig:example-nfri-vs-water-content-curve) are discarded prior to optimizing the curve to derive $\theta_{crit}$.


#### Summary: cleat-mark method 

- The method described above provides an objective means to choose a single water content for any infield soil. This value is termed $\theta_{crit}$.

- $\theta_{crit}$ is considered the lower boundary of the water contents suitable for play.

- A standard routine was adopted for building and repairing the soil specimens. The routine uses techniques similar to those empolyed on actual infields, including the Modified Proctor hammer and a drying apparatus to emulate natural sunlight. 

- It is recognized that the shape of the disturbance metric vs. water content curve may not be equivalent for all soils. The curve-fitting routine merits further study.


### Timeline 

The device was designed and fabricated in spring 2020. Calibration and tuning of the 3D scanner began July of 2020. The method described above has been tested on multiple soils. The final step will be to perform an error analysis across replicate soil specimens. 


## Paper 2: Applying the cleat-in, cleat-out method

Paper title: 

:  **Identifying the brittle-ductile transition of infield soil mixtures subjected to disturbance by baseball cleats**

### Overview 

This paper is the first chance to apply the method described in Section \@ref(cleatmark-method-development-chapter).

### Principal research questions

1. How does clay type interact with sand content to determine the critical water content corresponding to the cleat-in/cleat-out behavioral threshold?

<!-- 1. Do Atterberg limit tests correlate with the critical water contents? -->

1. For a given clay soil, what is the critical sand content above which the cleat-in/cleat-out surface cannot be achieved?

### Hypotheses



### Materials and Methods

This paper consists of three separate experiments. They are designed to test the effect of:

1. **Varying sand content:**  Five fine-grained soils will be mixed with a single sand in ratios ranging from 50-80% sand.
<!-- ^[Soils having no sand-size particles are rare; the 0% is stated here allegorically to indicate the 'pure' clay soil with no added sand.]  -->
Sand contents will be clustered around the transitional fines content to help identify the critical behavioral threshold for each clay type (see Figure \@ref(fig:sand-content-clustering)). 
This is preferred to simply testing mixes with equally-spaced sand contents, because the behavior change is nearly linear up to the transitional fines content (see Section \@ref(coarse-fraction-effects-on-soil-mixtures)).
This range of sand content is slightly larger than standard recommendations for infield mixes.
Therefore, standard materials can be compared with border cases. 

```{r sand-content-clustering, fig.cap='The sand contents for Experiment 1 in Chapter 2 will be deliberately clustered around the transitional fines content to provide the best data resolution', fig.scap='Clustering of sand contents for best data resolution'}

knitr::include_graphics('figs/pdf/sand-pcts-to-choose.pdf')
```


2. **Varying silt-to-clay ratio:**  The same fine-grained soils from (1) will each be separately mixed with quartz silt to produce soil mixtures having identical silt-to-clay ratios (SCR) but containing different clay minerals. 
These soils will be further mixed with sand to produce mixtures of either 60 or 70% sand. 
The target SCR values will be 0.25, 0.5, 1, 2, and 4, but some of the clays already contain too much silt to be tested at the lower SCR values. 
These soils would simply be tested at any ratios they are capable of meeting (Table \@ref(tab:planned-scr-values)).

```{r planned-scr-values, eval=TRUE}

scr_possible_vals <- tibble::tibble(
  `Clay name` = c('Calcium montmorillonite', 'Mixed-layer/illite-dominated', 'Fine-grained kaolinite', 'Sesquioxide-rich', 'High-silt soil'),
  clay_pct = paste0(c(0.6, 0.5, 0.8, 0.8, 0.1), 0),
  silt_pct = paste0(format(1- as.numeric(clay_pct), digits = 2), 0),
  scr = format(as.numeric(silt_pct) / as.numeric(clay_pct), digits = 2)
  ) %>% 
  dplyr::arrange(scr) %>% 
  dplyr::rename(
    `% Clay-size` = clay_pct,
    `% Silt-size` = silt_pct,
    `Silt-to-clay ratio` = scr
  )

scr_possible_vals %>% 
  kableExtra::kbl(align = 'lccc',
                  booktabs = TRUE,
                  digits = 2,
                caption = 'The 5 soils from Experiment 1 have different silt-to-clay ratios; silt can be added to produce soils with equivalent SCR values but different clay minerals and clay particle sizes. High-silt soils cannot be tested at an SCR lower than their existing value.',
                caption.short = 'Adjusted silt-to-clay ratios of "pure" clays') %>% 
  kableExtra::row_spec(0, bold = TRUE) %>% 
  kableExtra::add_header_above(header = c(' ' = 1, 'Approximate particle-size parameters' = 3)) %>% 
  kableExtra::kable_styling()
  
```


3. **Varying sand type:**  Two of the clays from Experiment (1) will be chosen based on having high and low toughness.
They will be mixed with 4 types of sand at 4 sand contents (50, 60, 70, and 75%) for a total of 32 mixes. 
The sand types include a "coarse", "medium" and "fine" with similar uniformity coefficients $C_u$ and a fourth sand having similar D~50~ to the "medium" sand but a larger $C_u$. 
This design allows a comparison of both size and uniformity to be made for a both low- and high-toughness clays.



### Timeline 

These experiments will be conducted throughout Summer and Fall 2021 (see Figure \@ref(fig:gantt-chart)).

## Paper 3: Toughness of sand-clay mixtures

Paper title: 

:  **Toughness-water content relations of clay soils via unconfined compression testing**

### Overview 

Infield soils have two critical water contents that define the range of acceptable consistency. The lower boundary is defined by the cleat-in,cleat-out effect. Chapters 1 and 2 address the lower boundary. 

The upper boundary of water content is governed by toughness and shear strength. 
Although much emphasis has been given to the cleat-in/cleat-out effect, this upper boundary of water content has weightier implications because above this water content the game simply cannot be played. 
Section \@ref(importance-of-the-infield) described the financial and scheduling implications of postponements. 

This paper is the compliment to Section \@ref(cleatmark-method-development-chapter). 
Its goal is to create a new way to use already-established tests for measuring the toughness of soil mixtures. 
Together, these data can establish both ends of the water content spectrum for a given soil. 

The method development for this paper will not be nearly as intensive as that of Paper 1. 
For the most part, the techniques already exist and I am simply using them in a new way. 


### Principal research questions

1. Can soil toughness be measured using unconfined compression tests?

2. How does toughness change as a function of water content for different types of clay soils?

3. How does the toughness-water content relationship change as sand is added to the clays?

### Hypotheses

1. Soil toughness can be measured with unconfined compression tests. By testing both specimens dry and wet of the plastic limit, one can interpolate their maximum toughness, which occurs at the plastic limit (i.e. onset of brittle fracturing).

2. Higher plasticity soils will have less change in toughness for a unit change in water content. The maximum toughness of the clay types will be in order of montmorillonite >> mixed-layer/illite > kaolinite > iron-oxide rich > high-silt soil. 

3. Clays with higher maximum toughness will require more sand to reduce their toughness. Because they maintain similar toughness over a broader range of water content, the behavior of the soil is less affected by sand additions.

### Materials and Methods

Recall that toughness is computed as the total work done by a loading procedure up to failure (Section \@ref(toughness-definitions)). 
In a hypothetical sense any test which applies a known load and measures a deformation could be used to measure toughness. 
@Barnes2013 suggested his apparatus would correlate well with the Moisture Condition Value test, which is the logarithm of the number of blows needed to compact a fixed mass of soil to a pre-determined volume.

This study will attempt to use an established machine test, the unconfined compression test (UCS).
This test is often utilized for compacted clay specimens, but in most cases the only parameter of interest is peak strength at failure.
However the test also allows stress-strain measurements to be recoreded throughout the test, and it is trivial to compute toughness from these data. 

The same mixtures tested in Section \@ref(cleatmark-method-development-chapter) will be used for this study. 

The soils will be wetted to their adhesion limit and packed into a 5-cm diameter steel tube with a dynamic compaction effort of 2,700 kN-m m^3^ (equivalent to the ASTM modified Proctor compaction test, D1557-12e1 [-@ASTMD15572015]. 
The soil will be packed in a single lift to minimize heterogeneities in the specimen which could arise due to lack of binding between successive lifts. 
Preparing the specimens in a relatively soft condition also ensures minimal air entrapment. 
For each mixture, 6 replicate cylinders will be prepared. 

The specimens will be extruded with a manual hydraulic bottle jack (Figure \@ref(fig:proctor-extruder)). 
One specimen will be immediately sealed in an air-tight plastic bag. 
The rest will be slowly air dried under a loose polyethylene sheet. 
Each specimen will be dried to progressively lower water contents and sealed in a plastic bag until testing, with the final specimen being completely air-dried. 
The goal is to evaluate at least 3 water contents where ductile behavior is observed and at least 2 samples where brittle behavior is observed.
This will allow the maximum toughness value to be bracketed by the tests and a curve to be fit on a plot of toughness vs. water content.

```{r proctor-extruder, fig.cap='Bottle jack specimen extruder for preparing compression test specimens.', out.width='80%'}
knitr::include_graphics('images/gilson_stock_proctor_extruder_photo.jpg')
```


The specimens will be subjected to unconfined compression tests at the Penn State Civil Infrastructure Testing and Evaluation Laboratory. 
Axial strain and nominal stress will be recorded up to 20% strain or an abrupt failure criterion [@ASTMD2166M-13]. 
The water content of the specimen will then be determined.  

A smooth curve will be fitted to the stress-strain curve using general additive models in the R language for statistical computing [@R-core2021]. 
Toughness will be computed as the definite integral up to failure. An arbitrary failure criterion (i.e. maximum acceptable strain) will be chosen for the ductile specimens; this depends on the degree of acceptable deformation by the groundskeeper and has not yet been calculated. 

Toughness will be plotted against water content. 
It is anticipated that this relationsip will follow a bi-linear or semi-logarithmic shape, as for the Barnes apparatus [@Barnes2013]. 
Figure \@ref(fig:barnes-toughness-vs-water-content-example-plot) shows such a plot. 

```{r barnes-toughness-vs-water-content-example-plot, fig.cap='Toughness $T$ of London clay as a function of water content (from Barnes, 2013)', fig.scap='Example toughness vs. $w$ plot from Barnes (2013)'}
knitr::include_graphics('./images/barnes-example-toughness-vs-w-plot.png')
```


Finally, the coefficients from the toughness-water content relationship for each sample can be analyzed as a function of sand content and clay type. 
This two-way linear model will permit the toughness slope to be computed for any soil based on its initial toughness. 

### Timeline 

These tests will be completed beginning in Fall 2021 and continue through Summer of 2022 (see Figure \@ref(fig:gantt-chart)). 


## Paper 4: Oversize partcles in Atterberg limit tests {#oversize-particles-atterberg-limits-experiment}

Paper title: 

:  **Effect of oversize particles on Atterberg limits of artificial sand-clay mixtures **

### Principal research questions

1. Can Atterberg limit tests be performed when sand particles up to 2 mm sieve diameter are included in a soil?

2. What is the effect of using coarser or finer sand?

3. What is the effect of sand uniformity?

### Hypotheses

1. The tests can be performed using identical methodology to ASTM D4318 with the 425 &mu;m washing step eliminated

1. The liquid limit will be lower for coarser sands due to reduced particle surface area.

1. Coarser sand will cause greater particle interference in the plastic limit thread as it nears its 3.2 mm diameter. The thread will crumble prematurely, raising the plastic limit value.

1. The combined effect of (2) and (3) will yield a smaller plasticity index for coarser sand. 

1.The results of the experiment can be used to apply a correction for the presence of oversize particles without their removal prior to testing. 

### Materials and Methods 

Three separate experiments will be performed.
Each will mix two or more sands with the same clay at various sand %.
The three experiments are:

1. Five sands of different size but similar $C_u$

1. Two sands with same $D_{50}$ and $C_u$ but different roundness

1. Two sands with similar $D_{50}$ but different $C_u$ 


### Timeline 

I started this experiment during the initial COVID-19 lockdown. 
Atterberg limits were the only lab tests I could realistically complete from my house. 
I finished collecting the data over the past winter. 

I have begun analyzing the data and writing the manuscript.
I plan to submit to the Soil Science Society Journal in fall of 2021. 

## Paper 5: Synthesis of concepts

Paper title: 

:  **A rational basis for the design of soil mixtures used on baseball and softball infields**


### Principal research questions 

1. How can better infield mixes be designed?

2. How can the performance of an existing mix be improved without replacing it?

3. What criteria best relate to infield performance, defined as the range of water contents where the soil is both plastic and stiff enough to support athletic maneuvers?

### Hypotheses 

1. Infield mix design should start with the toughness of an available clay soil, not the final sand %.

2. The level of play and maintenance budget will dictate the desired toughness level. 

3. The upper bound of the amount of clay soil component that should be included in the mix is a function of the dry shear strength of the mix because it is this property that governs the workability of the mix (i.e. the ability to groom it with implements and hand tools).

4. If a given toughness level is desired, the % sand needed to achieve this can be computed from empirical equations.

5. Ideally, toughness should be directly measured when designing a new mix; however it can also be estimated from an empirical correlation with the Atterberg limits

6. Particle size analysis is acceptable for quality control purposes, but not for design. Only once a desired blend of a particular sand with a particular clay is established through toughness testing can a definite ratio of sand-size particles to fines be defined for that mix. 

7. Amending existing soils should be done on the basis of plastictity rather than silt-to-clay ratio. The resulting mixture's properties will not be a linear interpolation between the two; thus a calibration of Atterberg limit results may be required by making several mixtures (for example 0, 20, 40, 60, 80, and 100% of soil A with the implied amount of soil B) to determine the proper amendment ratio.


### Materials and Methods 

This paper is primarily a synthesis of the methods papers described above. It will combine the methods into a single framework for designing infield mixes. Simple metrics will be defined, and the framework will be tested by using materials which were _not_ tested in the other experiments to validate the theory's merit. 

### Timeline 

This is the final paper I will write as it encompasses all the lab work and other publications. I anticipate writing it in the second half of 2022.
